@{
    ViewData["Title"] = "My Folders";
}
<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" asp-append-version="true" href="~/css/myfolders.css" />
    <title>@ViewData["Title"]</title>
    <!-- Pour la drop zone-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/dropzone/5.5.1/dropzone.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dropzone/5.5.1/dropzone.js"></script>
</head>
<body>
    <div class="text-center">
        <h1 class="display-4">@ViewData["Title"]</h1>
    </div>

    <!--<div class="myfolders-container">
        <div class="myfolders-header">Mon dossier 1</div>
        <div class="myfolders-content"> test test test</div>
    </div>
    <div class="myfolders-container">
        <div class="myfolders-header">Mon dossier 1</div>
        <div class="myfolders-content"> test test test</div>
    </div>
    <div class="myfolders-container">
        <div class="myfolders-header">Mon dossier 1</div>
        <div class="myfolders-content"> test test test</div>
    </div>
    <div class="myfolders-container">
        <div class="myfolders-header">Mon dossier 1</div>
        <div class="myfolders-content"> test test test</div>
    </div>
    <div class="myfolders-container">
        <div class="myfolders-header">Mon dossier 1</div>
        <div class="myfolders-content"> test test test</div>
    </div>-->
    <!--<form action="/file-upload" class="dropzone">
        <div class="fallback">
            <input name="file" type="file" multiple />
        </div>
    </form>-->
    <!--<form action="upload.php" class="dropzone" id="dropzoneFrom">
        <div class="fallback">
            <input name="file" type="file" multiple />
        </div>
    </form>-->
    <!--<form action="/upload" method="POST" class="dropzone" id="my-dropzone">
        <div class="fallback">
            <input name="file" type="file" multiple />
            <input type="submit" value="Upload" />
        </div>
    </form>-->
    <!--<div align="center">
        <button type="button" class="btn btn-info" id="submit-all">Upload</button>
    </div><br /><br />
    <div id="preview"></div>-->


    <form action="/file-upload" class="dropzone">
        <div class="fallback">
            <input name="file" type="file" multiple />
        </div>
    </form>
    <button type="button" class="btn btn-info text-center" id="submit-all">Upload</button>


    <div class="dz-preview dz-file-preview">
        <div class="dz-details">
            <div class="dz-filename"><span data-dz-name></span></div>
            <div class="dz-size" data-dz-size></div>
            <img data-dz-thumbnail />
        </div>
        <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>
        <div class="dz-success-mark"><span>✔</span></div>
        <div class="dz-error-mark"><span>✘</span></div>
        <div class="dz-error-message"><span data-dz-errormessage></span></div>
    </div>

    <div id="preview"></div>


</body>
</html>

<script>

    $(document).ready(function () {

        Dropzone.options.dropzoneFrom =
        {
            autoProcessQueue: false,
            acceptedFiles: ".png,.jpg,.gif,.bmp,.jpeg",
            init: function () {
                var submitButton = document.querySelector('#submit-all');
                myDropzone = this;
                submitButton.addEventListener("click", function () {
                    myDropzone.processQueue();
                });
                this.on("complete", function () {
                    if (this.getQueuedFiles().length == 0 && this.getUploadingFiles().length == 0) {
                        var _this = this;
                        _this.removeAllFiles();
                    }
                    list_image();
                });
            },
        };

        list_image();

        function list_image()
        {
            $.ajax({
                url: "upload.php",
                success: function (data) {
                    $('#preview').html(data);
                }
            });
        }

        $(document).on('click', '.remove_image', function ()
        {
            var name = $(this).attr('id');
            $.ajax({
                url: "upload.php",
                method: "POST",
                data: { name: name },
                success: function (data) {
                    list_image();
                }
            })
        });

    });
</script>
